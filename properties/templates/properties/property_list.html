<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Property Listings</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f7f9fb; }
        .container { max-width: 900px; }
        .card { transition: all 0.3s ease; }
        .card:hover { transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); }
    </style>
</head>
<body class="p-4 sm:p-8">
    <div class="container mx-auto">
        <h1 class="text-4xl font-extrabold text-indigo-700 mb-2">üè† Property Listings</h1>
        <h2 class="text-xl font-semibold text-gray-600 mb-6">Caching Demo (Tasks 1-4)</h2>
        
        <div class="p-4 bg-indigo-100 rounded-lg shadow-inner mb-6">
            <p class="text-lg font-medium text-indigo-800">
                <strong>Rendered Time:</strong> <span id="renderTime">{{ "now"|date:"H:i:s" }}</span> 
                <span class="text-sm text-indigo-600">(Task 1 View Cache)</span>
            </p>
            <p class="text-sm text-indigo-700 mt-1">
                If the time **does not change** on refresh, the **View Cache** is working. If the list count changes after deleting, the **Signals** are working!
            </p>
        </div>

        <hr class="mb-6 border-indigo-200">

        {% if properties %}
            <h2 class="text-2xl font-bold text-gray-800 mb-4">Found {{ properties|length }} Properties:</h2>
            <div class="space-y-4">
                {% for property in properties %}
                <div class="card bg-white p-5 rounded-xl shadow-lg border border-gray-100 flex justify-between items-center">
                    <div>
                        <strong class="text-xl text-gray-900">{{ property.title }}</strong> 
                        <span class="text-sm text-indigo-500 ml-3">({{ property.location }})</span>
                        <p class="text-lg font-semibold text-green-600 mt-1">Price: ${{ property.price }}</p>
                        <p class="text-xs text-gray-400 mt-0.5">Created: {{ property.created_at|date:"Y-m-d H:i:s" }}</p>
                    </div>

                    <!-- Deletion Form (Task 4) -->
                    <form action="{% url 'delete_property' property.pk %}" method="post" class="ml-4">
                        {% csrf_token %} 
                        <button type="submit" 
                            class="bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded-lg transition duration-150 shadow-md">
                            Delete
                        </button>
                    </form>
                </div>
                {% endfor %}
            </div>
        {% else %}
            <p class="text-xl text-red-500 font-semibold">No properties found. Run a script to populate the database!</p>
        {% endif %}

    </div>
</body>
</html>